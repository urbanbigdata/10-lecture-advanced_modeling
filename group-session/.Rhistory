# Load packages
library(dplyr)
library(magrittr)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
head(gapminder)
m1 = glm(corruption ~ region)
m1 = glm(data = gapminder, corruption ~ region)
summary(m1)
head(gapminder)
hist(gapminder$income)
hist(gapminder$corruption)
head(gapminder)
cpi = read.csv("/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_perception_index.csv")
names(cpi)
names(cpi)
cpi = subset(cpi, select="x2012")
cpi = subset(cpi, select=c("geo","x2012")
cpi = subset(cpi, select=c("geo","x2012"))
cpi = subset(cpi, select=c("geo","x2012"))
cpi = subset(cpi, select=c("geo","X2012"))
names(cpi) = c("name", "corruption_index")
df = gapminder %>% inner_join(cpi, by="name")
str(cpi)
cpi = read.csv("/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_perception_index.csv")
cpi = subset(cpi, select=c("geo","X2012"))
names(cpi) = c("name", "corruption_index")
cpi$name = as.character(cpi$name)
df = gapminder %>% inner_join(cpi, by="name")
cpi = subset(cpi, select=c("geo","X2012"))
names(cpi) = c("name", "corruption_index")
str(cpi)
cpi = read.csv("/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_perception_index.csv")
cpi = subset(cpi, select=c("geo","X2012"))
names(cpi) = c("name", "corruption_index")
str(cpi)
str(gapminder)
df = gapminder %>% inner_join(cpi, by="name")
gapminder$name = as.character(gapminder$name)
df = gapminder %>% inner_join(cpi, by="name")
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
gapminder$name = as.character(gapminder$name)
cpi = read.csv("/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_perception_index.csv")
cpi = subset(cpi, select=c("geo","X2012"))
names(cpi) = c("name", "corruption_index")
cpi$name = as.character(cpi$name)
str(cpi)
str(gapminder)
df = gapminder %>% inner_join(cpi, by="name")
head(gapminder)
head(df)
library(ggplot2)
ggplot(df, aes(x="corruption_index", y="corruption")) + geom_point()
ggplot(df, aes(x=corruption_index, y=corruption)) + geom_point()
head(df)
write.csv(df, "/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_data.csv")
write.csv(df, "/Users/andyhong/Documents/GitHub/urbanbigdata/10-lecture-advanced_modeling/group-session/corruption_data.csv", row.names = F)
m1 = glm(data = gapminder, corruption ~ region)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
m1 = glm(data = gapminder, corruption ~ region)
hist(gapminder$corruption)
summary(m1)
df = gapminder %>% filter(region %in% c("africa","europe"))
m1 = glm(df = gapminder, corruption ~ region)
head(df)
m1 = glm(df = df, corruption ~ region)
head(df)
df = gapminder %>% filter(region %in% c("africa","americas"))
head(df)
m1 = glm(df = df, corruption ~ region)
df$corruption
df = gapminder %>% filter(region %in% c("africa","asia"))
head(df)
df$corruption
m1 = glm(df = df, corruption ~ region)
df$corruption
df = gapminder %>% filter(region %in% c("americas","asia"))
head(df)
df$corruption
m1 = glm(df = df, corruption ~ region)
df = gapminder %>% filter(region %in% c("americas","asia","europe"))
head(df)
df$corruption
m1 = glm(df = df, corruption ~ region)
m1 = glm(df = gapminder, corruption ~ region)
head(df)
df$corruption
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
m1 = glm(df = gapminder, corruption ~ region)
head(gapminder)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
head(gapminder)
name(gapminder)
names(gapminder)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
names(gapminder)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
names(gapminder)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
df = gapminder %>% filter(region %in% c("africa","europe"))
head(df)
names(gapminder)
df$corruption
m1 = glm(df = gapminder, corruption ~ region)
gapminder
m1 = glm(data = gapminder, corruption ~ region)
summary(m1)
m1 = glm(data = df, corruption ~ region)
summary(m1)
exp(-0.43376)
df2 = df %>%
group_by(region, corruption) %>%
summarise(freq=n()) %>%
mutate(all=sum(freq),prob=freq/all,odds=prob/(1-prob),logodds=log(odds)) %>%
round(.,5)
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
recode(c("africa" = 1, "europe"= 0))
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
recode(., c("africa" = 1, "europe"= 0))
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
mutate(recode(africa = c("africa" = 1, "europe"= 0)))
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
mutate(recode(region, africa = c("africa" = 1, "europe"= 0)))
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
mutate(recode(region, c("africa" = 1, "europe"= 0)))
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
mutate(recode(region, "africa" = 1, "europe"= 0))
head(df)
df = gapminder %>%
filter(region %in% c("africa","europe")) %>%
mutate(africa = recode(region, "africa" = 1, "europe"= 0))
head(df)
df = gapminder %>%
mutate(africa = recode(region, "africa" = 1, .default= 0))
head(df)
df2 = df %>%
group_by(africa, corruption) %>%
summarise(freq=n()) %>%
mutate(all=sum(freq),prob=freq/all,odds=prob/(1-prob),logodds=log(odds)) %>%
round(.,5)
df2
# Install packages
# install.packages("dplyr")
# install.packages("magrittr")
install.packages("pander")
library(pander)
pander(df2)
table(df2)
pander(df2)
m1 = glm(data = df, corruption ~ africa)
m1 = glm(data = df2, corruption ~ africa)
summary(m1)
exp(1.110e-16)
m1 = glm(data = df2, corruption ~ africa, family = binomial)
summary(m1)
m1 = glm(data = df, corruption ~ africa, family = binomial)
summary(m1)
pander(df2)
exp(1.7433)
0.22973/4.35294
2.40625/0.41558
0.41558/2.40625
0.29358/0.70642
2.40625/4.35294
-1.47085/-0.87807
-0.87807/-1.47085
1-0.87807
model1 = glm(data = df, corruption ~ income, family = binomial)
model2 = glm(data = df, corruption ~ income + population, family = binomial)
model3 = glm(data = df, corruption ~ income + population + democracy, family = binomial)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
head(gapminder)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population, family = binomial)
model3 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
library(jtools)
library(ggstance)
library(huxtable)
plot_summs(model1, model2)
model1 = glm(data = gapminder, corruption ~ income + population, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + region, family = binomial)
model3 = glm(data = gapminder, corruption ~ income + population + region + democracy, family = binomial)
summary(m1)
library(jtools)
library(ggstance)
library(huxtable)
plot_summs(model1, model2)
plot_summs(model1, model2, scale=TRUE)
model1 = glm(data = gapminder, corruption ~ income + population, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
model3 = glm(data = gapminder, corruption ~ income + population + democracy + region, family = binomial)
plot_summs(model1, model2, scale=TRUE)
plot_summs(model1, model2, exp = TRU)
plot_summs(model1, model2, exp = TRUE)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
plot_summs(model1, model2, model3, exp=TRUE)
summary(m1)
summary(model1)
model1 = glm(data = gapminder, corruption ~ income + population, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
plot_summs(model1, model2, exp=TRUE)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
plot_summs(
model2, exp=TRUE, scale=TRUE)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
plot_summs(model1, model2, exp=TRUE)
View(gapminder)
plot_summs(model1, model2, exp=TRUE)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
model1 = glm(data = gapminder, corruption ~ income + region, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + region + democracy, family = binomial)
View(gapminder)
summary(model1)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
model2 = glm(data = gapminder, corruption ~ income + region + lifeExp, family = binomial)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + lifeExp, family = binomial)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
head(gapminder)
model1 = glm(data = gapminder, corruption ~ region, family = binomial)
model2 = glm(data = gapminder, corruption ~ region + income, family = binomial)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
plot_summs(model1, model2, exp=TRUE)
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
export_summs(model1, model2)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
export_summs(model1, model2)
export_summs(model1, model2, exp=TRUE)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
export_summs(model1, model2, exp=TRUE)
export_summs(model1, model2)
summ(model1, model2)
summ(model1)
summ(model1, exp=TRUE, scale=TRUE)
summ(model2, exp=TRUE, scale=TRUE)
summ(model2, exp=TRUE)
summ(model2)
summ(model2, digits=3)
summ(model2, digits=4)
summ(model2, exp=TRUE, digits=4)
summary(model2)
plot_summs(model1, model2)
export_summs(model1, model2)
export_summs(model1, model2, digit=4)
export_summs(model1, model2, digits=4)
head(gapminder)
head(gapminder)
# We will scale the population variable to make it comparable to other variables.
gapminder = gapminder %>% mutate(pop_per_10000 = population/10000)
head(gapminder)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
# We will scale the population variable to make it comparable to other variables.
gapminder = gapminder %>% mutate(pop_per_10k = population/10000)
head(gapminder)
model2 = glm(data = gapminder, corruption ~ income + pop_per_10k + democracy, family = binomial)
summary(model2)
export_summs(model1, model2, digits=4)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + pop_per_10k + democracy, family = binomial)
summary(model2)
export_summs(model1, model2, digits=4)
summary(model2)
summary(model1)
summary(model2)
head(gapminder)
model2 = glm(data = gapminder, corruption ~ income + pop_per_10k, family = binomial)
summary(model2)
export_summs(model1, model2, digits=4)
summary(model2)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
summary(model1)
summary(model2)
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
names(gdbp)
names(gdp)
gdp = subset(gdp, select=c("country","X2011"))
names(gdp) = c("name","X2011")
head(gdp)
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
names(gdp) = c("name","total_gdp")
head(gdp)
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
head(gdp)
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
gdp = subset(gdp, select=c("country","X2011"))
head(gdp)
colnames(gdp) = c("name","total_gdp")
head(gdp)
df = gapminder %>% left_join(gdp, by="name")
gapminder$name as.character(gapminder$name)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
gdp = subset(gdp, select=c("country","X2011"))
colnames(gdp) = c("name","total_gdp")
gapminder$name as.character(gapminder$name)
gapminder$name = as.character(gapminder$name)
gdp$name = as.character(gdp$name)
df = gapminder %>% left_join(gdp, by="name")
head(df)
model1 = glm(data = gapminder, corruption ~ total_gdp, family = binomial)
model2 = glm(data = gapminder, corruption ~ total_gdp + population + democracy, family = binomial)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
gdp = read.csv("/Users/andyhong/Downloads/total_gdp_us_inflation_adjusted.csv")
gdp = subset(gdp, select=c("country","X2011"))
colnames(gdp) = c("name","total_gdp")
head(gdp)
gapminder$name = as.character(gapminder$name)
gdp$name = as.character(gdp$name)
gapminder = gapminder %>% left_join(gdp, by="name")
model1 = glm(data = gapminder, corruption ~ total_gdp, family = binomial)
model2 = glm(data = gapminder, corruption ~ total_gdp + population + democracy, family = binomial)
summary(model1)
summary(model2)
plot_summs(model1, model2)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
head(gapminder)
summary(model1)
summary(model2)
plot_summs(model1, model2)
export_summs(model1, model2, digits=4)
gapminder$income_10k = gapminder$income * 10000
model1 = glm(data = gapminder, corruption ~ income_10k, family = binomial)
model2 = glm(data = gapminder, corruption ~ income_10k + population + democracy, family = binomial)
summary(model1)
head(gapminder)
gapminder$income_10k = gapminder$income * 1000
model1 = glm(data = gapminder, corruption ~ income_10k, family = binomial)
model2 = glm(data = gapminder, corruption ~ income_10k + population + democracy, family = binomial)
summary(model1)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
head(gapminder)
summary(model1)
summary(model2)
plot_summs(model1, model2)
export_summs(model1, model2, digits=4)
exp(-0.0001)
summ(model1, exp=TRUE, scale=TRUE)
summ(model1, exp=TRUE)
summ(model1, exp=TRUE, digits=4)
summ(model1, exp=TRUE, digits=6)
export_summs(model1, model2, digits=6)
summ(model1, exp=TRUE, digits=8)
summ(model2, exp=TRUE, digits=4)
summ(model1, exp=TRUE, digits=4)
summary(model1)
summary(model2)$coeff
exp(summary(model2)$coeff)
summary(model2)$coeff
coef(model2)
exp(coef(model2))
summary(model2)
exp(coef(model2))
install.packages("oddsratio")
library(oddsratio)
model1 = or_glm(data = gapminder, corruption ~ income, family = binomial)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
model1_result = or_glm(data = gapminder, model=model1)
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
exp(cbind(Odds=coef(model2), confint(model2)))
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + democracy, family = binomial)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
summary(model1)
# Show coefficient plot
plot_summs(model1, model2)
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + democracy + region, family = binomial)
# Show the original results
summary(model1)
summary(model2)
gapminder
model2 = glm(data = gapminder, corruption ~ income + democracy + lifeExp, family = binomial)
summary(model2)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + democracy, family = binomial)
# Show the original results
summary(model1)
summary(model2)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE)
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE, scale=TRUE)
model2 = glm(data = gapminder, corruption ~ income + democracy + region, family = binomial)
# Show the original results
summary(model1)
summary(model2)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
gapminder
gapminder$region
unique(gapminder$region)
gapminder = read.csv("/Users/andyhong/Documents/vsp_bigdata/group-session/10-lecture/gapminder_data_2011.csv")
head(gapminder)
model1 = glm(data = gapminder, corruption ~ income, family = binomial)
model2 = glm(data = gapminder, corruption ~ income + democracy + region, family = binomial)
# Show the original results
summary(model1)
summary(model2)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
model2 = glm(data = gapminder, corruption ~ income + region, family = binomial)
exp(cbind(Odds=coef(model2), confint(model2)))
model2 = glm(data = gapminder, corruption ~ income + democracy + population, family = binomial)
# Show the original results
summary(model1)
summary(model2)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE)
model2 = glm(data = gapminder, corruption ~ income + democracy, family = binomial)
# Show the original results
summary(model1)
summary(model2)
# Show the exponentiated results
exp(cbind(Odds=coef(model1), confint(model1)))
exp(cbind(Odds=coef(model2), confint(model2)))
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE)
# Show the original results
summary(model1)
summary(model2)
model2 = glm(data = gapminder, corruption ~ income + population + democracy, family = binomial)
summary(model2)
exp(cbind(Odds=coef(model2), confint(model2)))
# Show coefficient plot
plot_summs(model1, model2, exp=TRUE)
